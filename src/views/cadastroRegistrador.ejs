<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro de registrador</title>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <!-- BOOTSTRAP ICONS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
  <!-- TAILWINDCSS -->
  <link rel="stylesheet" href="tailwindcss.css">
</head>
<body class="bg-gray-200 text-gray-600 relative">
  <%- include('components/navbar') %>
  <%- include('components/modal') %>

  <section class="bg-white max-w-screen-lg min-h-80 m-auto p-10 shadow-lg  ">
  
    <!-- CRIAR REGISTRADOR -->
    <form id="createRegistrador"class="block m-auto text-gray-600  mb-10" >
      <button type="submit" class="ml-auto mr-5 flex items-center space-x-2 justify-between bg-green-500 hover:bg-green-600  duration-100 hover:shadow-md text-white px-4 py-2 rounded-sm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-fill-gear" viewBox="0 0 16 16">
          <path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0m-9 8c0 1 1 1 1 1h5.256A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1 1.544-3.393Q8.844 9.002 8 9c-5 0-6 3-6 4m9.886-3.54c.18-.613 1.048-.613 1.229 0l.043.148a.64.64 0 0 0 .921.382l.136-.074c.561-.306 1.175.308.87.869l-.075.136a.64.64 0 0 0 .382.92l.149.045c.612.18.612 1.048 0 1.229l-.15.043a.64.64 0 0 0-.38.921l.074.136c.305.561-.309 1.175-.87.87l-.136-.075a.64.64 0 0 0-.92.382l-.045.149c-.18.612-1.048.612-1.229 0l-.043-.15a.64.64 0 0 0-.921-.38l-.136.074c-.561.305-1.175-.309-.87-.87l.075-.136a.64.64 0 0 0-.382-.92l-.148-.045c-.613-.18-.613-1.048 0-1.229l.148-.043a.64.64 0 0 0 .382-.921l-.074-.136c-.306-.561.308-1.175.869-.87l.136.075a.64.64 0 0 0 .92-.382zM14 12.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0"/>
        </svg>
        <span>Salvar</span>
      </button>
  
      <div class="flex items-center justify-center space-x-4">
        <div class="flex flex-col">
          <label for="name" class="text-sm">Nome</label>
          <input required type="text" name="name"  class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
        <div class="flex flex-col">
          <label for="email" class="text-sm">E-mail</label>
          <input type="email" name="email"  class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
        <div class="flex flex-col">
          <label for="login" class="text-sm">Login</label>
          <input required type="text" name="login" class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
        <div class="flex flex-col">
          <label for="password" class="text-sm">Senha</label>
          <input required type="password" name="password" class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
      </div>
    </form>

    <!-- ATUALIZAR REGISTRADOR -->
    <form  action="" method="post" class="hidden m-auto text-gray-600  mb-10" id="updateRegistrador">
      
      <div class="flex items-center justify-end space-x-2">
        <button type="submit" class="mr-5 flex items-center space-x-2 justify-between bg-blue-500 hover:bg-blue-600  duration-100 hover:shadow-md text-white px-4 py-2 rounded-sm">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-fill-up" viewBox="0 0 16 16">
            <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.854 1.5 1.5a.5.5 0 0 1-.708.708L13 11.707V14.5a.5.5 0 0 1-1 0v-2.793l-.646.647a.5.5 0 0 1-.708-.708l1.5-1.5a.5.5 0 0 1 .708 0M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
            <path d="M2 13c0 1 1 1 1 1h5.256A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1 1.544-3.393Q8.844 9.002 8 9c-5 0-6 3-6 4"/>
          </svg>
          <span>Atualizar</span>
        </button>
        <button type="button" onclick="switchFormRegistrador('create')" class=" mr-5 flex items-center space-x-2 justify-between bg-red-500 hover:bg-red-600  duration-100 hover:shadow-md text-white px-2 py-2 rounded-sm">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-x-lg font-semibold" viewBox="0 0 16 16">
            <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/>
          </svg>
        </button>
      </div>
      
      <div class="flex items-center justify-center space-x-4">
        <div class="flex flex-col">
          <label for="name" class="text-sm">Nome</label>
          <input id="updatename" required type="text" name="name"  class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
        <div class="flex flex-col">
          <label for="email" class="text-sm">E-mail</label>
          <input id="updateEmail" type="email" name="email"  class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
        <div class="flex flex-col">
          <label for="login" class="text-sm">Login</label>
          <input id="updateLogin" required type="text" name="login" class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
        <div class="flex flex-col">
          <label for="password" class="text-sm">Senha</label>
          <input id="updatePassword" placeholder="Digite uma nova senha" required type="password" name="password" class="border-2 border-gray-300 bg-gray-100 px-4 py-2 rounded-sm">
        </div>
      </div>
    </form>

    <hr class="mb-10">

    <!-- LISTA DE REGISTRADORES -->
    <table class="m-auto mb-10">
      <caption class="text-lg font-semibold">REGISTRADORES CADASTRADOS</caption>

      <thead >
        <tr class="bg-gray-500 text-white">
          <th class="border border-gray-600 px-4 py-2">Id</th>
          <th class="border border-gray-600 px-4 py-2">Nome</th>
          <th class="border border-gray-600 px-4 py-2">Login</th>
          <th class="border border-gray-600 px-4 py-2">Email</th>
          <th class="border border-gray-600 px-4 py-2">Registro</th>
          <th class="border border-gray-600 px-4 py-2">Editar</th>
          <th class="border border-gray-600 px-4 py-2">Remover</th>
        </tr>
      </thead>
      <tbody>


        <% function converterParaPtBr(dataHora) {
          const data = new Date(dataHora);
          const dia = data.getDate().toString().padStart(2, '0');
          const mes = (data.getMonth() + 1).toString().padStart(2, '0');
          const ano = data.getFullYear();
          const horas = data.getHours().toString().padStart(2, '0');
          const minutos = data.getMinutes().toString().padStart(2, '0');
          return `${dia}/${mes}/${ano} -  ${horas}h:${minutos}min`;
        }%>
        <% registradores.map(e => { %>     

          <tr>
            <td class="border border-gray-400 px-4 py-2"><%= e.id %></td>
            <td class="border border-gray-400 px-4 py-2"><%= e.name %></td>
            <td class="border border-gray-400 px-4 py-2"><%= e.login %></td>
            <td class="border border-gray-400 px-4 py-2"><%= e.email %></td>
            <td class="border border-gray-400 px-4 py-2 text-center"><%= converterParaPtBr(e.date )?? '-'  %></td>
            <td class="border border-gray-400 px-4 py-2 text-center">
              <button onclick="handleUpdateRegistrador('<%= e.id %>')" class="flex items-center space-x-2 justify-between bg-blue-500 hover:bg-blue-600  duration-100 hover:shadow-md text-white px-4 py-2 rounded-sm">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen-fill" viewBox="0 0 16 16">
                  <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001"/>
                </svg>
                <span>Editar</span>
              </button>
            </td>
            <td class="border border-gray-400 px-4 py-2 text-center">
              <button type="button" onclick="handleRemoveRegistrador('<%= e.id %>')" class="flex items-center space-x-2 justify-between bg-red-500 hover:bg-red-600 duration-100  hover:shadow-md text-white px-4 py-2 rounded-sm">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                  <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"/>
                </svg>
                <span>Remover</span>
              </button>
            </td>
          </tr>    
        <% }) %>
      </tbody>
    </table>
    
  </section>
</body>
</html>
<script src="cadastroRegistrador.js"></script>
